<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¢Ø´ÙˆØ± ÙƒØ§Øª | Ashur Kat Premium</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&family=Aref+Ruqaa:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            /* ğŸ¨ Ø¨Ø§Ù„ÙŠØª Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø³ÙˆÙ…Ø±ÙŠØ© */
            --primary: #8b2e18;   /* Ø£Ø­Ù…Ø± Ù‚Ø±Ù…ÙŠØ¯ÙŠ */
            --royal-blue: #1e3a8a; /* Ø£Ø²Ø±Ù‚ Ø¹Ø´ØªØ§Ø± */
            --accent: #d4af37;    /* Ø°Ù‡Ø¨ÙŠ Ù…Ù„ÙƒÙŠ */
            --bg-body: #f7f5f0;   /* Ù„ÙˆÙ† ÙˆØ±Ù‚ Ø§Ù„Ø¨Ø±Ø¯ÙŠ */
            --bg-card: #ffffff;
            --text-dark: #2d1b0e; /* Ø¨Ù†ÙŠ ØºØ§Ù…Ù‚ Ù„Ù„ÙƒØªØ§Ø¨Ø© */
            --text-gray: #6b5c52;
            --shadow: 0 10px 30px rgba(139, 46, 24, 0.1);
            --radius: 16px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Tajawal', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background-color: var(--bg-body); 
            color: var(--text-dark); 
            padding-bottom: 100px; 
            overflow-x: hidden;
            background-image: radial-gradient(#d4af37 0.5px, transparent 0.5px);
            background-size: 20px 20px;
        }

        header { 
            position: sticky; top: 0; z-index: 100; padding: 15px 20px 15px; 
            border-bottom-left-radius: 25px; border-bottom-right-radius: 25px; 
            box-shadow: var(--shadow); 
            background: rgba(255, 255, 255, 0.98); 
            backdrop-filter: blur(10px); 
            border-bottom: 3px solid var(--accent);
        }
        
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        
        .logo { 
            font-family: 'Aref Ruqaa', serif; 
            font-weight: 700; 
            color: var(--primary); 
            font-size: 1.8rem; 
        }
        .logo span { color: var(--royal-blue); font-family: 'Aref Ruqaa', serif; }
        
        .back-btn { background: var(--royal-blue); color: #fff; padding: 8px 15px; border-radius: 50px; font-size: 0.9rem; font-weight: bold; cursor: pointer; display: none; transition: 0.3s; }
        
        .search-box { position: relative; width: 100%; margin-top: 10px; }
        .search-input { width: 100%; padding: 14px 45px 14px 20px; border-radius: 12px; border: 1px solid #e0dace; background: #fff; font-size: 1rem; transition: 0.3s; }
        .search-input:focus { background: #fff; box-shadow: 0 0 0 2px var(--royal-blue); border-color: transparent; outline: none; }
        .search-icon { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--primary); }

        .tabs-scroll { overflow-x: auto; white-space: nowrap; padding: 20px 20px 10px; scrollbar-width: none; }
        .tabs-scroll::-webkit-scrollbar { display: none; }
        .tab-pill { 
            display: inline-flex; align-items: center; gap: 8px;
            padding: 10px 22px; border-radius: 12px; 
            background: white; color: var(--text-dark); 
            margin-left: 12px; font-weight: 700; font-size: 0.9rem; 
            cursor: pointer; transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #e0dace;
        }
        .tab-pill.active { 
            background: var(--primary); 
            color: white; 
            border-color: var(--primary);
            box-shadow: 0 5px 15px rgba(139, 46, 24, 0.3); 
            transform: translateY(-2px); 
        }

        .grid { display: grid; grid-template-columns: 1fr; gap: 20px; padding: 20px; }
        @media(min-width: 600px){ .grid { grid-template-columns: 1fr 1fr; } }

        .vendor-card { 
            background: var(--bg-card); border-radius: var(--radius); overflow: hidden; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: transform 0.3s; position: relative; height: 200px;
            cursor: pointer; border: 1px solid #ebe5da;
        }
        .vendor-card:active { transform: scale(0.98); }
        .v-img { height: 100%; width: 100%; object-fit: cover; filter: brightness(0.9); transition: 0.5s; }
        .v-info-overlay { 
            position: absolute; bottom: 0; left: 0; width: 100%; 
            background: linear-gradient(to top, rgba(45, 27, 14, 0.95), transparent); 
            padding: 20px; color: white; display: flex; flex-direction: column; justify-content: flex-end; height: 100%;
        }
        .v-name { font-weight: 800; font-size: 1.4rem; margin-bottom: 5px; color: #fff; }
        .v-meta { font-size: 0.85rem; opacity: 0.9; display: flex; gap: 10px; align-items: center; }
        .v-tag { background: var(--accent); color: #000; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; }

        .products-area { display: none; padding: 20px; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; }
        .p-card { 
            background: var(--bg-card); border-radius: 12px; padding: 10px; 
            box-shadow: 0 3px 10px rgba(0,0,0,0.03); text-align: center; 
            position: relative; overflow: hidden; transition: 0.3s; border: 1px solid #ebe5da;
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .badge-hot { 
            position: absolute; top: 10px; left: 10px; 
            background: var(--royal-blue); color: white; font-size: 0.7rem; 
            padding: 4px 10px; border-radius: 4px; font-weight: bold; z-index: 10;
        }
        .p-img { width: 100%; height: 120px; object-fit: cover; border-radius: 8px; margin-bottom: 10px; }
        .p-name { font-weight: 700; font-size: 1rem; margin-bottom: 5px; color: var(--text-dark); line-height: 1.3; }
        .p-price { color: var(--primary); font-weight: 800; font-size: 1.1rem; }
        
        .p-btn { 
            margin-top: 8px; background: var(--text-dark); color: var(--accent); 
            border: none; padding: 8px; border-radius: 8px; 
            width: 100%; font-weight: bold; cursor: pointer; transition: 0.2s;
        }
        .p-btn:active { background: var(--accent); color: var(--text-dark); }

        .float-cart { 
            position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%); 
            width: 90%; max-width: 400px; background: var(--text-dark); color: var(--accent); 
            padding: 15px 25px; border-radius: 12px; display: none; 
            justify-content: space-between; align-items: center; 
            cursor: pointer; z-index: 1500; box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            border: 2px solid var(--accent); 
        }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(45, 27, 14, 0.7); z-index: 2000; display: none; justify-content: center; align-items: flex-end; backdrop-filter: blur(5px); }
        .modal-box { background: #fffdf9; width: 100%; max-width: 500px; border-radius: 20px 20px 0 0; padding: 30px; max-height: 90vh; overflow-y: auto; animation: slideUp 0.3s; border-top: 5px solid var(--primary); }
        @keyframes slideUp { from {transform: translateY(100%)} to {transform: translateY(0)}}

        .qty-control { display: flex; justify-content: center; align-items: center; gap: 20px; margin: 20px 0; }
        .qty-btn { width: 45px; height: 45px; background: #eee; border-radius: 8px; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-dark); }
        
        .action-btn { background: var(--primary); color: white; width: 100%; padding: 15px; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: 800; cursor: pointer; margin-top: 15px; box-shadow: 0 4px 15px rgba(139, 46, 24, 0.2); }
        
        .receipt { background: #fdfbf7; padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px dashed var(--text-gray); }
        .receipt-item { display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        
        .area-select { width: 100%; padding: 15px; border-radius: 12px; border: 2px solid var(--primary); background: #fff; font-size: 1rem; font-weight: bold; margin-bottom: 15px; outline: none; }
        
        .options-container { display: none; background: #fff; padding: 15px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #eee; }
        .opt-label { display: flex; gap: 10px; padding: 8px; cursor: pointer; }
        .note-input { width: 100%; padding: 15px; border-radius: 12px; border: 1px solid #ccc; margin-bottom: 10px; background: #fff; }
        
        .close-icon { 
            position: absolute; top: 15px; left: 15px; 
            background: #eee; width: 30px; height: 30px; 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            cursor: pointer; font-weight: bold; color: var(--text-dark); transition: 0.2s;
            z-index: 10;
        }
        .close-icon:active { transform: scale(0.9); }
    </style>
</head>
<body>

    <header>
        <div class="header-top">
            <div class="logo">Ø¢Ø´ÙˆØ± <span>ÙƒØ§Øª</span> ğŸ¦</div>
            <div class="back-btn" id="backBtn" onclick="showHome()">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© <i class="fas fa-home"></i></div>
        </div>
        <div class="search-box">
            <i class="fas fa-search search-icon"></i>
            <input type="text" id="searchInput" class="search-input" placeholder="Ø´Ù†Ùˆ Ù…Ø´ØªÙ‡ÙŠ Ø§Ù„ÙŠÙˆÙ…ØŸ (Ø¨Ø±Ø¬Ø±ØŒ Ø¨ÙŠØªØ²Ø§...)" onkeyup="searchProducts()">
        </div>
    </header>

    <div class="tabs-scroll" id="mainTabs">
        <span class="tab-pill active" onclick="filterVendors('all', this)">Ø§Ù„ÙƒÙ„</span>
        <span class="tab-pill" onclick="filterVendors('restaurant', this)">ğŸ” Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</span>
        <span class="tab-pill" onclick="filterVendors('refreshments', this)">ğŸ¦ Ø§Ù„Ù…Ø±Ø·Ø¨Ø§Øª</span>
        <span class="tab-pill" onclick="filterVendors('supermarket', this)">ğŸ›’ Ø§Ù„Ù…Ø§Ø±ÙƒØª</span>
    </div>

    <div class="grid" id="vendorsGrid"></div>
    <div class="products-area grid" id="productsGrid"></div>

    <div class="float-cart" id="floatCart" onclick="showInvoice()">
        <span style="font-weight:700;">Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª <span id="cartCount" style="background:var(--accent); color:black; padding:2px 8px; border-radius:6px; font-size:0.8rem;">0</span></span>
        <span id="cartTotal" style="font-weight:800; font-size:1.1rem; color:var(--accent);">0 Ø¯.Ø¹</span>
    </div>

    <div class="modal-overlay" id="addModal">
        <div class="modal-box" style="position: relative;">
            <div class="close-icon" onclick="closeAddModal()">âœ•</div>
            
            <h3 id="modalItemName" style="text-align: center; color:var(--primary); margin-bottom:5px;"></h3>
            <p style="text-align:center; color:#777; font-size:0.9rem;">Ø§Ù„ÙƒÙ…ÙŠØ© ÙˆØ§Ù„Ø¥Ø¶Ø§ÙØ§Øª</p>
            
            <div class="qty-control">
                <button class="qty-btn" onclick="updateQty(-1)">-</button>
                <span id="qtyVal" style="font-size:1.5rem; font-weight:800; margin:0 15px;">1</span>
                <button class="qty-btn" onclick="updateQty(1)">+</button>
            </div>

            <div class="options-container" id="restaurantOptions">
                <label class="opt-label"><input type="checkbox" value="Ø¨Ø¯ÙˆÙ† Ø¨ØµÙ„"> Ø¨Ø¯ÙˆÙ† Ø¨ØµÙ„ ğŸ§…</label>
                <label class="opt-label"><input type="checkbox" value="ÙƒØ«Ø± ØµÙˆØµ"> ÙƒØ«Ø± ØµÙˆØµ ğŸ¥£</label>
                <label class="opt-label"><input type="checkbox" value="Ø®Ø¨Ø² Ø­Ø§Ø±"> Ø®Ø¨Ø² Ø­Ø§Ø± ğŸ”¥</label>
            </div>

            <div class="options-container" id="supermarketOptions">
                <label class="opt-label"><input type="checkbox" value="ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©"> ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© ğŸ“…</label>
                <label class="opt-label"><input type="checkbox" value="ÙƒÙŠØ³ Ø£Ø³ÙˆØ¯"> ÙƒÙŠØ³ Ø£Ø³ÙˆØ¯ âš«</label>
            </div>

            <div class="options-container" id="refreshmentOptions">
                <label class="opt-label"><input type="checkbox" value="Ø¨Ø¯ÙˆÙ† Ø«Ù„Ø¬"> Ø¨Ø¯ÙˆÙ† Ø«Ù„Ø¬ ğŸ§Š</label>
                <label class="opt-label"><input type="checkbox" value="ÙƒØ«Ø± ØµÙˆØµ"> ÙƒØ«Ø± ØµÙˆØµ/Ù†Ø³ØªÙ„Ø© ğŸ«</label>
            </div>

            <input type="text" id="itemNote" class="note-input" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø© Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)...">
            
            <div style="display:flex; gap:10px;">
                <button class="action-btn" onclick="addToCartConfirm()">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø© âœ…</button>
                <button class="action-btn" onclick="closeAddModal()" style="background:#eee; color:#333;">Ø¥Ù„ØºØ§Ø¡ âŒ</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="invoiceModal">
        <div class="modal-box">
            <h3 style="text-align:center; margin-bottom:20px; color:var(--primary);">Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨ ğŸ§¾</h3>
            
            <label style="font-weight:bold; display:block; margin-bottom:5px;">ğŸ“ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙˆØµÙŠÙ„:</label>
            <select id="deliveryArea" class="area-select" onchange="calculateFinalTotal()">
                <option value="" disabled selected>-- Ø§Ø®ØªØ± Ù…Ù†Ø·Ù‚ØªÙƒ --</option>
            </select>
            
            <input type="tel" id="customerPhone" class="note-input" placeholder="Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ (Ù„Ù„ØªÙˆØ§ØµÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶Ø±ÙˆØ±Ø©)" style="border: 2px solid var(--accent);">

            <textarea id="deliveryNote" class="note-input" style="height:80px;" placeholder="Ø§ÙƒØªØ¨ Ø£Ù‚Ø±Ø¨ Ù†Ù‚Ø·Ø© Ø¯Ø§Ù„Ø©ØŒ Ù„ÙˆÙ† Ø§Ù„Ø¨Ø§Ø¨..."></textarea>

            <div class="receipt" id="receiptBody"></div>
            
            <div style="background:#fdfbf7; padding:15px; border-radius:12px; border:1px solid #ebe5da;">
                <div style="display:flex; justify-content:space-between;"><span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</span> <span id="subTotalDisplay">0</span></div>
                <div style="display:flex; justify-content:space-between; color:#777;"><span>Ø§Ù„ØªÙˆØµÙŠÙ„:</span> <span id="deliveryFeeDisplay">--</span></div>
                <div style="display:flex; justify-content:space-between; color:var(--primary); font-weight:bold; display:none;" id="extraStopRow"><span>+ Ù…Ø­Ø·Ø© Ø«Ø§Ù†ÙŠØ©:</span> <span>1,000</span></div>
                <div style="display:flex; justify-content:space-between; margin-top:10px; font-weight:900; font-size:1.2rem; border-top:1px solid #ddd; padding-top:10px; color:var(--royal-blue);"><span>Ø§Ù„ÙƒÙ„ÙŠ:</span> <span id="grandTotalDisplay">0</span></div>
            </div>

            <button class="action-btn" style="background:#25D366; margin-top:20px;" onclick="sendToWhatsApp()">
                <i class="fab fa-whatsapp"></i> Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
            </button>
            <button class="action-btn" style="background:#eee; color:#333; margin-top:10px; box-shadow:none;" onclick="closeInvoice()">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</button>
        </div>
    </div>
    
    <div class="modal-overlay" id="confirmSentModal" style="z-index: 3000;">
        <div class="modal-box" style="text-align: center;">
            <i class="fab fa-whatsapp fa-4x" style="color:#25D366; margin-bottom:15px;"></i>
            <h3 style="color:var(--text-dark); margin-bottom:10px;">Ø£ÙƒÙ…Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</h3>
            <p style="color:#666; font-size:1rem; margin-bottom:20px;">
                ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ <b>Ø¥Ø±Ø³Ø§Ù„</b> ÙÙŠ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ØŒ Ø«Ù… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù‡Ù†Ø§ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ù…Ø·Ø¹Ù….
            </p>
            <div style="display:flex; gap:10px;">
                <button class="action-btn" onclick="finalizeOrder()" style="background:var(--primary); margin-top:0;">
                    âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŒ Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ø¹Ù…
                </button>
                <button class="action-btn" onclick="closeConfirmModal()" style="background:#eee; color:#333; margin-top:0;">
                    Ø¥Ù„ØºØ§Ø¡
                </button>
            </div>
        </div>
    </div>

    <script>
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby1elvhQB0-svU-_H5xh2jrWtTfOeRRiCmGdrXo0RAzM32SfsfJ0t5yOeKSvZE29SY6Xg/exec';
        const driversPhone = { 'driver1': '9647717324456', 'driver2': '9647717324456', 'default': '9647717324456' };
        const EXTRA_STOP_FEE = 1000;

        const deliveryRegions = [
            { name: "Ø¨Ø¹Ø§Ø¬Ø©", price: 2250, driver_key: "driver1" }, { name: "Ø§Ù„Ø­ÙŠ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ", price: 2250, driver_key: "driver1" },
            { name: "Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©", price: 2250, driver_key: "driver1" }, { name: "Ø­ÙŠ Ø§Ù„Ø¬Ù…Ø¹ÙŠØ©", price: 2250, driver_key: "driver1" },
            { name: "ØªÙ„ Ø§Ù„Ù…Ø§Ø¬Ø¯", price: 2250, driver_key: "driver1" }, { name: "ØªÙ„ Ø§Ù„Ø­Ù…Ø¯Ø§Ù†", price: 2250, driver_key: "driver1" },
            { name: "Ø§Ù„Ø·ÙˆØ¨", price: 2250, driver_key: "driver1" }, { name: "Ø­ÙŠ Ø§Ù„Ø¶ØºØ·", price: 2250, driver_key: "driver1" },
            { name: "Ø§Ù„Ø®ØµÙ…", price: 2500, driver_key: "driver2" }, { name: "Ø§Ù„Ø³ÙƒÙ†ÙŠØ©", price: 4250, driver_key: "driver2" }
        ];

        const vendors = [
            { id: 'fuad', name: 'Ù…Ø·Ø¹Ù… ÙØ¤Ø§Ø¯', type: 'restaurant', img: 'img/el.jpg', time: '30-45 Ø¯', open: 16, close: 2 },
            { id: 'osama', name: 'Ù…Ø·Ø¹Ù… ÙˆÙ…Ø´ÙˆÙŠØ§Øª Ø£Ø³Ø§Ù…Ø©', type: 'restaurant', img: 'img/asamh.jpg', time: '40-50 Ø¯', open: 8, close: 1 },
            { id: 'hala', name: 'Ù‡Ù„Ø§ ÙÙˆØ¯', type: 'restaurant', img: 'img/hala.jpg', time: '35-45 Ø¯', open: 16, close: 2 },
            { id: 'ziad', name: 'Ù…Ø§Ø±ÙƒØª Ø²ÙŠØ§Ø¯', type: 'supermarket', img: 'img/z.jpg', time: '20-30 Ø¯', open: 8, close: 2 }, 
            { id: 'blue', name: 'Ø¨Ù„Ùˆ Ø¨ÙŠØ±ÙŠ', type: 'refreshments', img: 'img/blu.jpg', time: '15-25 Ø¯', open: 12, close: 2 },
            { id: 'kinder', name: 'ÙƒÙ†Ø¯Ø±', type: 'refreshments', img: 'img/kn.jpg', time: '15-25 Ø¯', open: 12, close: 2 },
            { id: 'spicy', name: 'Ø³Ø¨Ø§ÙŠØ³ÙŠ', type: 'restaurant', img: 'img/sp.jpg', time: '25-40 Ø¯', open: 16, close: 2 },
        ];

        const products = [
             { id: 55, vid: 'spicy', name: 'Ø¨Ø±Ø¬Ø± Ù„Ø­Ù…', price: 4000, isHot: true, img: 'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=500' },
            { id: 56, vid: 'spicy', name: 'Ø´Ø§ÙˆØ±Ù…Ø§ Ø¯Ø¬Ø§Ø¬', price: 2500, isHot: false, img: 'https://images.unsplash.com/photo-1529006557810-274b9b2fc783?w=500' },
            { id: 57, vid: 'spicy', name: 'Ø¨ÙŠØªØ²Ø§ ÙˆØ³Ø·', price: 8000, isHot: false, img: 'https://images.unsplash.com/photo-1604382354936-07c5d9983bd3?w=500' },
            { id: 58, vid: 'spicy', name: 'Ø±ÙŠØ²Ùˆ Ø¯Ø¬Ø§Ø¬', price: 5000, isHot: false, img: 'https://images.unsplash.com/photo-1604908176997-125f25cc6f3d?w=500' },
            { id: 59, vid: 'spicy', name: 'ÙÙ†ÙƒØ±', price: 1000, isHot: false, img: 'https://images.unsplash.com/photo-1630384060421-cb20d0e0649d?w=500' },
            { id: 1, vid: 'fuad', name: 'Ø¨Ø±Ø¬Ø± Ù„Ø­Ù…', price: 4000, isHot: true, img: 'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=500' },
            { id: 2, vid: 'fuad', name: 'Ø´Ø§ÙˆØ±Ù…Ø§ Ø¯Ø¬Ø§Ø¬', price: 2500, isHot: false, img: 'https://images.unsplash.com/photo-1529006557810-274b9b2fc783?w=500' },
            { id: 3, vid: 'fuad', name: 'Ø¨ÙŠØªØ²Ø§ ÙˆØ³Ø·', price: 8000, isHot: false, img: 'https://images.unsplash.com/photo-1604382354936-07c5d9983bd3?w=500' },
            { id: 4, vid: 'fuad', name: 'Ø±ÙŠØ²Ùˆ Ø¯Ø¬Ø§Ø¬', price: 5000, isHot: false, img: 'https://images.unsplash.com/photo-1604908176997-125f25cc6f3d?w=500' },
            { id: 5, vid: 'fuad', name: 'ÙÙ†ÙƒØ±', price: 1000, isHot: false, img: 'https://images.unsplash.com/photo-1630384060421-cb20d0e0649d?w=500' },
            { id: 34,vid:'fuad', name: 'Ø¨ÙŠØ¨Ø³ÙŠ', price: 500, isHot: false, img: 'https://images.unsplash.com/photo-1629203851122-3726ecdf080e?w=500' },
            { id: 10, vid: 'osama', name: 'Ù†ÙØ± ÙƒØ¨Ø§Ø¨', price: 10000, isHot: true, img: 'img/kabab.jpg' },
            { id: 11, vid: 'osama', name: 'Ø¯Ø¬Ø§Ø¬Ø© ÙØ­Ù…', price: 14000, isHot: false, img: 'img/djaj.jpg' },
            { id: 12, vid: 'osama', name: 'ØªÙƒØ© Ù„Ø­Ù…', price: 12000, isHot: false, img: 'img/tkh.jpg' },
            { id: 50, vid: 'hala', name: 'Ø³Ù†Ø¯ÙˆÙŠØ¬ ÙƒØ±Ø³Ø¨ÙŠ', price: 4500, isHot: true, img: 'https://images.unsplash.com/photo-1626645738196-c2a7c87a8f58?w=500' },
            { id: 51, vid: 'hala', name: 'Ø³Ù†Ø¯ÙˆÙŠØ¬ Ø¥Ø³ÙƒØ§Ù„ÙˆØ¨', price: 4500, isHot: false, img: 'https://images.unsplash.com/photo-1536521642388-441263f88a61?w=500' },
            { id: 52, vid: 'hala', name: 'Ø³Ø§Ù†Ø¯ÙˆÙŠØ´ ÙØ§Ù‡ÙŠØªØ§', price: 4500, isHot: false, img: 'img/faheta.jpg' },
            { id: 53, vid: 'hala', name: 'Ø¨ÙŠØªØ²Ø§ Ø¯Ø¬Ø§Ø¬', price: 7500, isHot: false, img: 'https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=500' },
            { id: 54, vid: 'hala', name: 'ØªØ´ÙŠÙƒÙ† Ø³Ø¨Ø§ÙŠØ³ÙŠ', price: 6000, isHot: false, img: 'https://images.unsplash.com/photo-1615557960916-5f4791effe9d?w=500' },
            { id: 34, vid: 'hala', name: 'Ø¨ÙŠØ¨Ø³ÙŠ', price: 500, isHot: false, img: 'https://images.unsplash.com/photo-1629203851122-3726ecdf080e?w=500' },
            { id: 20, vid: 'ziad', name: 'Ø²ÙŠØª (1 Ù„ØªØ±)', price: 2250, isHot: false, img: 'img/tunsa.jpg' },
            { id: 21, vid: 'ziad', name: 'Ø´Ø§ÙŠ (500Øº)', price: 4000, isHot: false, img: 'https://images.unsplash.com/photo-1597481499750-3e6b22637e12?w=500' },
            { id: 22, vid: 'ziad', name: 'Ù†ÙˆØªÙŠÙ„Ø§ ÙˆØ³Ø·', price: 5000, isHot: false, img: 'img/nu.jpg' },
            { id: 23, vid: 'ziad', name: 'ØªÙ…Ù† Ø¹Ù†Ø¨Ø± (ÙƒÙŠÙ„Ùˆ)', price: 2500, isHot: false, img: 'https://images.unsplash.com/photo-1586201375761-83865001e31c?w=500' },
            { id: 34, vid: 'ziad', name: 'Ø¨ÙŠØ¨Ø³ÙŠ', price: 500, isHot: true, img: 'https://images.unsplash.com/photo-1629203851122-3726ecdf080e?w=500' },
            { id: 30, vid: 'blue', name: 'Ø¹ØµÙŠØ± Ø¨Ø±ØªÙ‚Ø§Ù„', price: 3000, isHot: false, img: 'https://images.unsplash.com/photo-1613478223719-2ab802602423?w=500' },
            { id: 31, vid: 'blue', name: 'ÙƒÙˆÙƒØªÙŠÙ„ Ø¨Ù„Ùˆ Ø¨ÙŠØ±ÙŠ', price: 4000, isHot: true, img: 'img/koktel.jpg' },
            { id: 40, vid: 'kinder', name: 'Ø¢ÙŠØ³ ÙƒØ±ÙŠÙ… ÙƒÙ†Ø¯Ø±', price: 2000, isHot: true, img: 'https://images.unsplash.com/photo-1497034825429-c343d7c6a68f?w=500' },
            { id: 41, vid: 'kinder', name: 'ÙˆØ§ÙÙ„ Ù†ÙˆØªÙŠÙ„Ø§', price: 4000, isHot: false, img: 'https://images.unsplash.com/photo-1562376552-0d160a2f238d?w=500' },
            { id: 42, vid: 'kinder', name: 'ÙƒØ±ÙŠØ¨ Ù†ÙˆØªÙŠÙ„Ø§', price: 5000, isHot: false, img: 'https://images.unsplash.com/photo-1519676867240-f03562e64548?w=500' },
            { id: 43, vid: 'kinder', name: 'ÙƒØ±ÙŠØ¨ Ù…Ø´ÙƒÙ„', price: 5000, isHot: false, img: 'https://images.unsplash.com/photo-1519676867240-f03562e64548?w=500' },
        ];

        let cart = [];
        let currentVendor = null;
        let tempProduct = null;
        let currentQty = 1;

        window.onload = () => {
            renderVendors(vendors);
            populateRegions();
            loadSavedRegion();
            checkPendingOrder(); 
        };

        document.addEventListener("visibilitychange", () => {
            if (document.visibilityState === "visible") {
                checkPendingOrder();
            }
        });

        // Ø¯Ø§Ù„Ø© ÙØ­Øµ Ø§Ù„ÙˆÙ‚Øª
        function isOpen(v) {
            const now = new Date();
            const h = now.getHours(); // Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            
            // Ø§Ø°Ø§ ÙƒØ§Ù† ÙˆÙ‚Øª Ø§Ù„Ø§ØºÙ„Ø§Ù‚ (2) Ø£ØµØºØ± Ù…Ù† ÙˆÙ‚Øª Ø§Ù„ÙØªØ­ (16)ØŒ ÙŠØ¹Ù†ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù… Ù„ÙŠÙ„ÙŠ
            if (v.close < v.open) {
                // Ù…ÙØªÙˆØ­ Ø§Ø°Ø§ Ø§Ù„Ø³Ø§Ø¹Ø© Ø£ÙƒØ¨Ø± Ù…Ù† 16 (4 Ø§Ù„Ø¹ØµØ±) Ø£Ùˆ Ø£ØµØºØ± Ù…Ù† 2 (2 Ø§Ù„ÙØ¬Ø±)
                return h >= v.open || h < v.close;
            } else {
                // Ø¯ÙˆØ§Ù… Ù†Ù‡Ø§Ø±ÙŠ Ø¹Ø§Ø¯ÙŠ
                return h >= v.open && h < v.close;
            }
        }

        function checkPendingOrder() {
            if(localStorage.getItem('pendingOrder')) {
                document.getElementById('confirmSentModal').style.display = 'flex';
            }
        }

        function populateRegions() {
            const select = document.getElementById('deliveryArea');
            deliveryRegions.forEach((region, index) => {
                const option = document.createElement('option');
                option.value = index; 
                option.text = `ğŸ“ ${region.name} - (${region.price.toLocaleString()} Ø¯.Ø¹)`;
                select.appendChild(option);
            });
        }
        function loadSavedRegion() {
            const savedIdx = localStorage.getItem('userRegionIdx');
            if(savedIdx !== null) document.getElementById('deliveryArea').value = savedIdx;
        }

        // ğŸ†• Ø¯Ø§Ù„Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©: ØªØ­ÙˆÙ„ Ø§Ù„ÙˆÙ‚Øª ÙˆØªÙƒØªØ¨ "ÙŠÙØªØ­ Ø§Ù„Ø³Ø§Ø¹Ø© ÙƒØ°Ø§"
        function renderVendors(list) {
            const container = document.getElementById('vendorsGrid');
            container.innerHTML = '';
            list.forEach(v => {
                const openStatus = isOpen(v); // Ù‡Ù„ Ù…ÙØªÙˆØ­ØŸ
                
                // â° Ø­Ø³Ø§Ø¨ ÙˆÙ‚Øª Ø§Ù„ÙØªØ­ Ø¨ØµÙŠØºØ© 12 Ø³Ø§Ø¹Ø© (ØµØ¨Ø§Ø­Ø§Ù‹/Ù…Ø³Ø§Ø¡Ù‹)
                let openTimeDisplay = v.open;
                let ampm = "Øµ";
                
                if (v.open >= 12) {
                    openTimeDisplay = v.open > 12 ? v.open - 12 : v.open;
                    ampm = "Ù…";
                }
                if (v.open === 0 || v.open === 24) {
                    openTimeDisplay = 12;
                    ampm = "Øµ";
                }

                // Ø³ØªØ§ÙŠÙ„ Ù„Ù„Ù…ØºÙ„Ù‚
                const style = openStatus ? '' : 'filter: grayscale(100%); opacity: 0.8; pointer-events: none;';
                
                // Ø§Ù„Ù†Øµ Ø§Ù„ÙŠ ÙŠØ·Ù„Ø¹: ÙŠØ§ Ø§Ù…Ø§ "ØªÙˆØµÙŠÙ„" ÙŠØ§ Ø§Ù…Ø§ "ÙŠÙØªØ­ Ø§Ù„Ø³Ø§Ø¹Ø© ÙƒØ°Ø§"
                const statusText = openStatus ? 
                    `<span class="v-tag"><i class="fas fa-motorcycle"></i> ØªÙˆØµÙŠÙ„</span>` : 
                    `<span class="v-tag" style="background:#333; color:#fff; font-size:0.75rem;">ğŸ”“ ÙŠÙØªØ­ ${openTimeDisplay}:00 ${ampm}</span>`;
                
                container.innerHTML += `
                <div class="vendor-card" onclick="openVendor('${v.id}')" style="${style}">
                    <img src="${v.img}" class="v-img">
                    <div class="v-info-overlay">
                        <div class="v-name">${v.name}</div>
                        <div class="v-meta">
                            <span class="v-tag"><i class="fas fa-clock"></i> ${v.time}</span>
                            ${statusText}
                        </div>
                    </div>
                </div>`;
            });
        }

        function filterVendors(type, el) {
            document.querySelectorAll('.tab-pill').forEach(t => t.classList.remove('active'));
            el.classList.add('active');
            type === 'all' ? renderVendors(vendors) : renderVendors(vendors.filter(v => v.type === type));
        }

        function openVendor(vid) {
            currentVendor = vendors.find(v => v.id === vid);
            
            // Ø­Ù…Ø§ÙŠØ© Ø§Ø¶Ø§ÙÙŠØ©: Ù…Ù†Ø¹ Ø§Ù„ÙØªØ­ Ø§Ø°Ø§ Ù…ØºÙ„Ù‚
            if (!isOpen(currentVendor)) return alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø·Ø¹Ù… Ù…ØºÙ„Ù‚ Ø§Ù„Ø¢Ù† ğŸŒ™");

            document.getElementById('vendorsGrid').style.display = 'none';
            document.getElementById('mainTabs').style.display = 'none';
            document.getElementById('productsGrid').style.display = 'grid';
            document.getElementById('backBtn').style.display = 'block';
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';
            products.filter(p => p.vid === vid).forEach(p => renderProductCard(p, grid));
        }
        function renderProductCard(p, container) {
            container.innerHTML += `
                <div class="p-card">
                    ${p.isHot ? '<div class="badge-hot">ğŸ”¥ Ø§Ù„Ø£ÙƒØ«Ø± Ø·Ù„Ø¨Ø§Ù‹</div>' : ''}
                    <img src="${p.img}" class="p-img">
                    <div class="p-name">${p.name}</div>
                    <div class="p-price">${p.price.toLocaleString()} Ø¯.Ø¹</div>
                    <button class="p-btn" onclick="openAddModal(${p.id})">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø© +</button>
                </div>`;
        }
        function showHome() {
            document.getElementById('searchInput').value = '';
            document.getElementById('productsGrid').style.display = 'none';
            document.getElementById('vendorsGrid').style.display = 'grid';
            document.getElementById('mainTabs').style.display = 'block';
            document.getElementById('backBtn').style.display = 'none';
        }
        function searchProducts() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const grid = document.getElementById('productsGrid');
            if(query === '') { showHome(); return; }
            document.getElementById('vendorsGrid').style.display = 'none';
            document.getElementById('mainTabs').style.display = 'none';
            document.getElementById('productsGrid').style.display = 'grid';
            document.getElementById('backBtn').style.display = 'block';
            grid.innerHTML = '';
            const results = products.filter(p => p.name.includes(query));
            if(results.length === 0) {
                grid.innerHTML = '<p style="grid-column:1/-1; text-align:center; color:#888; margin-top:20px;">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬</p>';
                return;
            }
            results.forEach(p => renderProductCard(p, grid));
        }
        function openAddModal(pid) {
            tempProduct = products.find(p => p.id === pid);
            currentQty = 1;
            document.getElementById('qtyVal').innerText = 1;
            document.getElementById('modalItemName').innerText = tempProduct.name;
            document.getElementById('itemNote').value = ""; 
            document.querySelectorAll('.options-container').forEach(div => div.style.display = 'none');
            document.querySelectorAll('.options-container input').forEach(c => c.checked = false);
            if(currentVendor.type === 'restaurant') document.getElementById('restaurantOptions').style.display = 'block';
            else if (currentVendor.type === 'supermarket') document.getElementById('supermarketOptions').style.display = 'block';
            else if (currentVendor.type === 'refreshments') document.getElementById('refreshmentOptions').style.display = 'block';
            document.getElementById('addModal').style.display = 'flex';
        }
        function updateQty(n) { if(currentQty + n >= 1) { currentQty += n; document.getElementById('qtyVal').innerText = currentQty; } }
        function addToCartConfirm() {
            let notes = [];
            document.querySelectorAll('.options-container[style*="block"] input:checked').forEach(c => notes.push(c.value));
            const textNote = document.getElementById('itemNote').value.trim();
            if(textNote) notes.push(textNote);
            cart.push({ ...tempProduct, qty: currentQty, notes: notes, vendorName: currentVendor.name, vendorId: currentVendor.id });
            document.getElementById('addModal').style.display = 'none';
            updateCartUI();
        }
        
        function closeAddModal() {
            document.getElementById('addModal').style.display = 'none';
        }

        function updateCartUI() {
            const count = cart.length;
            const total = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            document.getElementById('cartCount').innerText = count;
            document.getElementById('cartTotal').innerText = total.toLocaleString() + ' Ø¯.Ø¹';
            document.getElementById('floatCart').style.display = count > 0 ? 'flex' : 'none';
        }
        function showInvoice() {
            const container = document.getElementById('receiptBody');
            container.innerHTML = '';
            cart.forEach((item, idx) => {
                const notes = item.notes.length ? `<div style="font-size:0.8rem; color:#888;">(${item.notes.join('ØŒ ')})</div>` : '';
                container.innerHTML += `
                    <div class="receipt-item">
                        <div>
                            <div style="font-weight:700;">${item.qty}x ${item.name}</div>
                            <div style="font-size:0.8rem; color:var(--primary);">${item.vendorName}</div>
                            ${notes}
                        </div>
                        <div style="display:flex; align-items:center; gap:10px;">
                            <span style="font-weight:bold;">${(item.price * item.qty).toLocaleString()}</span>
                            <i class="fas fa-trash" style="color:#ff4d4d; cursor:pointer;" onclick="removeItem(${idx})"></i>
                        </div>
                    </div>`;
            });
            loadSavedRegion();
            calculateFinalTotal(); 
            document.getElementById('invoiceModal').style.display = 'flex';
        }
        function removeItem(i) { cart.splice(i, 1); cart.length === 0 ? closeInvoice() : showInvoice(); updateCartUI(); }
        function closeInvoice() { document.getElementById('invoiceModal').style.display = 'none'; }
        
        function calculateFinalTotal() {
            const foodTotal = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            const areaIndex = document.getElementById('deliveryArea').value;
            if(areaIndex !== "") localStorage.setItem('userRegionIdx', areaIndex);
            const uniqueVendors = new Set(cart.map(item => item.vendorId));
            const vendorCount = uniqueVendors.size;
            let deliveryPrice = 0;
            let extraStopPrice = 0;
            document.getElementById('subTotalDisplay').innerText = foodTotal.toLocaleString() + " Ø¯.Ø¹";
            if (areaIndex !== "") {
                deliveryPrice = deliveryRegions[areaIndex].price;
                if (vendorCount > 1) {
                    extraStopPrice = (vendorCount - 1) * EXTRA_STOP_FEE;
                    document.getElementById('extraStopRow').style.display = 'flex';
                    document.querySelector('#extraStopRow span:last-child').innerText = extraStopPrice.toLocaleString() + " Ø¯.Ø¹";
                } else { document.getElementById('extraStopRow').style.display = 'none'; }
                document.getElementById('deliveryFeeDisplay').innerText = deliveryPrice.toLocaleString() + " Ø¯.Ø¹";
                document.getElementById('grandTotalDisplay').innerText = (foodTotal + deliveryPrice + extraStopPrice).toLocaleString() + " Ø¯.Ø¹";
            } else {
                document.getElementById('deliveryFeeDisplay').innerText = "--";
                document.getElementById('extraStopRow').style.display = 'none';
                document.getElementById('grandTotalDisplay').innerText = foodTotal.toLocaleString() + " Ø¯.Ø¹";
            }
        }

        function sendToWhatsApp() {
            const areaIndex = document.getElementById('deliveryArea').value;
            const deliveryNote = document.getElementById('deliveryNote').value.trim();
            const customerPhone = document.getElementById('customerPhone') ? document.getElementById('customerPhone').value.trim() : "";
            
            if (cart.length === 0) return alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©!");
            if (areaIndex === "") return alert("Ø§Ø®ØªØ± Ù…Ù†Ø·Ù‚ØªÙƒ Ø£ÙˆÙ„Ø§Ù‹");

            const region = deliveryRegions[areaIndex];
            const targetPhone = driversPhone[region.driver_key] || driversPhone['default'];
            
            const foodTotal = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            const uniqueVendors = new Set(cart.map(item => item.vendorId));
            let extraStopPrice = 0;
            if (uniqueVendors.size > 1) extraStopPrice = (uniqueVendors.size - 1) * EXTRA_STOP_FEE;
            
            const deliveryFee = region.price;
            const grandTotal = foodTotal + deliveryFee + extraStopPrice;
            const isSystemOrder = cart.every(item => item.vendorId === 'fuad' || item.vendorId === 'hala');

            const orderData = {
                region: region.name,
                items: cart.map(i => `${i.qty}x ${i.name} (${i.vendorName}) {${i.price * i.qty}}`).join(' | ') + (customerPhone ? ` [Øª: ${customerPhone}]` : ""),
                total: grandTotal,
                notes: deliveryNote
            };
            
            localStorage.setItem('pendingOrder', JSON.stringify(orderData));

            let msg = "";
            if (isSystemOrder) {
                msg += `*ğŸ”” Ù…Ù‡Ù…Ø© Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨ (Pickup)* \n`;
                msg += `ğŸš¨ *ÙƒØ§Ø¨ØªÙ†:* Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§ØµÙ„ Ù„Ù„Ù…Ø·Ø¹Ù… Ø¹Ø§Ù„Ø³ÙŠØ³ØªÙ….\n`;
                msg += `*Ø¨Ø³ Ø±ÙˆØ­ Ø§Ø³ØªÙ„Ù… ÙˆÙˆØµÙ„.*\n\n`;
            } else {
                msg += `*ğŸš€ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - Ø´Ø±Ø§Ø¡ ÙˆØªÙˆØµÙŠÙ„* \n`;
            }

            msg += `*ğŸ“ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©:* ${region.name}\n`;
            if(customerPhone) msg += `ğŸ“ *Ù‡Ø§ØªÙ Ø§Ù„Ø²Ø¨ÙˆÙ†:* ${customerPhone}\n`;
            if(deliveryNote) msg += `ğŸ“ *Ù…Ù„Ø§Ø­Ø¸Ø©:* ${deliveryNote}\n`;
            msg += `---------------------------\n`;
            
            cart.forEach(item => {
                const notes = item.notes.length ? ` (${item.notes.join('ØŒ ')})` : '';
                msg += `â–ªï¸ ${item.qty}x ${item.name} [${item.vendorName}] ${notes}\n`;
            });

            msg += `---------------------------\n`;
            msg += `ğŸ’° *Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ (ÙˆØ§ØµÙ„):* ${grandTotal.toLocaleString()} Ø¯.Ø¹\n`;
            let details = `(Ø£ÙƒÙ„: ${foodTotal} + ØªÙˆØµÙŠÙ„: ${deliveryFee}`;
            if(extraStopPrice > 0) details += ` + Ù…Ø­Ø·Ø§Øª: ${extraStopPrice}`;
            details += `)`;
            msg += `${details}\n`;
            msg += `ğŸ“ *Ø§Ù„Ù…ÙˆÙ‚Ø¹:* (ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù„ÙˆÙƒÙŠØ´Ù†)`;

            const whatsappURL = `https://wa.me/${targetPhone}?text=${encodeURIComponent(msg)}`;

            window.location.href = whatsappURL; 
            
            setTimeout(() => {
                document.getElementById('confirmSentModal').style.display = 'flex';
            }, 1000);
        }

        function finalizeOrder() {
            const storedData = localStorage.getItem('pendingOrder');
            
            if(storedData && GOOGLE_SCRIPT_URL) {
                const dataToSend = JSON.parse(storedData);
                
                fetch(GOOGLE_SCRIPT_URL, {
                    method: "POST",
                    mode: "no-cors",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(dataToSend)
                }).then(() => console.log("Sent to sheet"))
                  .catch(e => console.log("Error", e));
                  
                localStorage.removeItem('pendingOrder');
                
                document.getElementById('confirmSentModal').style.display = 'none';
                closeInvoice();
                cart = [];
                updateCartUI();
                alert("âœ… ØªÙ… Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ù…Ø·Ø¹Ù… Ø¨Ø·Ù„Ø¨Ùƒ!");
            } else {
                document.getElementById('confirmSentModal').style.display = 'none';
            }
        }

        function closeConfirmModal() {
            document.getElementById('confirmSentModal').style.display = 'none';
        }
        
        window.onclick = (e) => { 
            if(e.target.className === 'modal-overlay' && e.target.id !== 'confirmSentModal') {
                e.target.style.display = 'none';
            }
        }
    </script>
</body>
</html>

